<!--?php

$uri = "mysql://avnadmin:AVNS_55NTlcA08E_9D_zSc0k@lorenest-dawid1admin.j.aivencloud.com:10408/defaultdb?ssl-mode=REQUIRED";

$fields = parse_url($uri);

// build the DSN including SSL settings
$conn = "mysql:";
$conn .= "host=" . $fields["host"];
$conn .= ";port=" . $fields["port"];;
$conn .= ";dbname=defaultdb";
$conn .= ";sslmode=verify-ca;sslrootcert=ca.pem";

try {
    $pdo = new PDO($conn, $fields["user"], $fields["pass"]);
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); // Ustawienie trybu błędów
} catch (PDOException $e) {
    echo "Connection failed: " . $e->getMessage();
}
/*

try {
  $db = new PDO($conn, $fields["user"], $fields["pass"]);

  $stmt = $db->query("SELECT VERSION()");
  print($stmt->fetch()[0]);
} catch (Exception $e) {
  echo "Error: " . $e->getMessage();
}*/
?>
?php/*
function loadEnv() {
    $lines = file('.env');
    foreach ($lines as $line) {
        $line = rtrim($line);
        if (!empty($line) && $line[0] != '#') {
            list($key, $value) = explode('=', $line, 2);
            putenv("{$key}={$value}");
        }
    }
}

loadEnv(); 

$db_host = getenv('DB_HOST');
$db_user = getenv('DB_USER');
$db_pass = getenv('DB_PASS');
$db_name = getenv('DB_NAME');

try {
    $pdo = new PDO(
        "mysql:host={$db_host};port={$db_port};dbname={$db_name}",
        $db_user,
        $db_pass
    );    
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch (PDOException $e) {
    echo "Database connection failed: " . $e->getMessage();
    exit();
}

?>
?php
$db_host = 'lorenest-dawid1admin.j.aivencloud.com';
$db_user = 'avnadmin';
$db_pass = 'AVNS_55NTlcA08E_9D_zSc0k'; 
$db_name = 'defaultdb';

try {
    $pdo = new PDO("mysql:host={$db_host};dbname={$db_name}", $db_user, $db_pass);
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch (PDOException $e) {
    echo "Błąd połączenia z bazą danych: " . $e->getMessage();
    exit();
}
?>